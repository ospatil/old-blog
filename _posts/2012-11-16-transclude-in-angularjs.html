---
layout: post
title: Transclude in AngularJS
date: '2012-11-17T09:25:00.001+05:30'
author: Omkar Patil
tags:
- js
- javascript
- angularjs
modified_time: '2013-03-16T21:32:08.546+05:30'
thumbnail: http://4.bp.blogspot.com/-FRUFoqhYrR4/UKZi8sN54VI/AAAAAAAAAZU/EJq4KvTsy3g/s72-c/buttonbar.png
blogger_id: tag:blogger.com,1999:blog-3599227544422363853.post-6678481179090865890
blogger_orig_url: http://blog.omkarpatil.com/2012/11/transclude-in-angularjs.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><p><b>Transclude</b> - That's not a word you'll find in a dictionary :). Once you dive into <i>Angular</i>, creating custom directives is a daily chore and having good understanding of <i>transclusion</i> becomes imperative. To explain it in one sentence, transclusion consists of plucking out the content of a custom directive, processing it against right scope and then placing it at a marked position in the template of that directive. While the basic transclude using the built-in <i>ngTransclude</i> directive is easy enough, there isn't much clarity in some areas in terms of documentation or examples. These areas are - </p><ul><li>Purpose and usage of <b>transclude</b> argument that a directive <i>compile</i> function receives.</li><li>Purpose and usage of <b>$transclude</b> injectable in a Controller.</li><li>Isolate scope and transclude.</li><li>Transcluding into an attribute.</li></ul><p>I'll try to throw some light on these with the help of working fiddles.</p><h2>Basic transclude</h2><p>Let's start with the most basic transclude example. Let's say, we are creating a <b>buttonBar</b> directive that a user can use to add a group of buttons to a page. The directive takes care of alignment of the buttons. Just to note, I have used <b>Twitter Bootstrap</b> as CSS framework.</p><p><a target="_blank" href="http://jsfiddle.net/ospatil/A969Z/157/">Here is the fiddle for it.</a></p><iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/ospatil/A969Z/157/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe><br /><p>Take a look at the markup. The <b>buttonBar</b> directive wraps a couple of button elements. The button elements also have a class-based directive <i>"primary"</i> attached to them. Don't worry about it though, it simply attaches appropriate Twitter Bootstrap classes to them. The directive provides <i>transclude: true</i> attribute and it's template uses <i>ng-transclude</i> directive on a contained div. At run-time, Angular gets the content of the custom directive, processes it and sticks the resultant markup in the ng-transclude div in the template. And that's all there to it. Quite simple, isn't it?</p><h2>Transclude at multiple locations</h2><p>Lets say we would like to enhance our <i>buttonBar</i> directive to have two kinds of buttons - primary and secondary; with primary buttons right-aligned and secondary left-aligned. It would entail picking up the contents(buttons in our example) of the directive and adding them into two separate divs, one for primary buttons and the other for secondary buttons. <b>Transclude into two different locations, if you will.</b> The result should look something like this - </p><p><a href="http://4.bp.blogspot.com/-FRUFoqhYrR4/UKZi8sN54VI/AAAAAAAAAZU/EJq4KvTsy3g/s1600/buttonbar.png" imageanchor="1" style=""><img border="0" height="50" width="400" src="http://4.bp.blogspot.com/-FRUFoqhYrR4/UKZi8sN54VI/AAAAAAAAAZU/EJq4KvTsy3g/s400/buttonbar.png" /></a></p><p><b>Well, that's not possible with the default mechanism.</b> One approach to achieve this could be - </p><ol><li>Allowing the default transclude in an element in the template.</li><li>Programmatically moving child elements(buttons) to appropriate div.</li><li>Finally, removing the original transcluded element from DOM in compile or link function of the directive.</li></ol><p><a target="_blank" href="http://jsfiddle.net/ospatil/A969Z/158/">Here is a fiddle that demonstrates this approach.</a></p><iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/ospatil/A969Z/158/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe><br /><p>While this approach gives us the intended result, allowing default transclude to happen in an element and then removing it from DOM manually is not really efficient. That's where the <i>transclude</i> argument to compile function and <i>$transclude</i> injectable into Controller come into picture.</p><h2>Transclude argument to compile function in a directive</h2><p>The <a href="http://docs.angularjs.org/guide/directive">Angular developer guide for directive</a> gives following signature for the <b>compile</b> function of a directive -</p><pre>function compile(tElement, tAttrs, transclude) { ... }<br /></pre><p>And here is what it says about the third argument -</p><pre>transclude - A transclude linking function: function(scope, cloneLinkingFn).<br /></pre><p>Alright, let's use this function to achieve what we achieved in the last example without the need to transclude into an element and then removing it from DOM.</p><p><a target="_blank" href="http://jsfiddle.net/ospatil/A969Z/161/">Here is the fiddle for it.</a></p><iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/ospatil/A969Z/161/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe><br /><p>Please note there is no scope available in compile function and you'll have to pass the element that compile function received as the first argument to the transclude function. You might want to use this approach if you are already using the compile function (which is quite rare, at least for me) and don't need to work with scope. Otherwise, the next approach of injecting <i>$transclude</i> into Controller is the best bet.</p><h2>Injecting $transclude in a Controller</h2><p>The <a href="http://docs.angularjs.org/guide/directive">Angular developer guide for directive</a> states the following for <b>$transclude</b> injectable for Controller -</p><pre>$transclude - A transclude linking function pre-bound to the correct transclusion scope: function(cloneLinkingFn).<br /></pre><p><a target="_blank" href="http://jsfiddle.net/ospatil/A969Z/162/">And here is how we can use it for our buttonBar directive.</a></p><iframe style="width: 100%; height: 300px" src="http://jsfiddle.net/ospatil/A969Z/162/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe><br /><br /><h2>Transclude and scope</h2><p>The <a href="http://docs.angularjs.org/guide/directive">Angular developer guide for directive</a> mentions that a directive isolated scope and transclude scope are siblings. Now, what does that mean? If you take a careful look at previous example, you'll notice that parentController creates a scope, the <i>buttonBar</i> directive declares an isolated scope under it and as mentioned in the Angular documentation, transclude creates yet another scope. I have added log statements at appropriate places in the directive to illustrate the relationship between these three scopes. Here is how the output looks like - </p><p><a href="http://4.bp.blogspot.com/-bZaniELtmnU/UKZz88VMPaI/AAAAAAAAAZo/Vx4x19Hdvwc/s1600/transclude_scope.jpg" imageanchor="1" style=""><img border="0" height="71" width="400" src="http://4.bp.blogspot.com/-bZaniELtmnU/UKZz88VMPaI/AAAAAAAAAZo/Vx4x19Hdvwc/s400/transclude_scope.jpg" /></a><br /></p><p>You can clearly see the directive isolate scope and transclude scopes are siblings.</p><h2>Transcluding into an attribute</h2><p><b>Well, you can't really do that</b> but achieve something to that effect using the <a href="http://stackoverflow.com/a/11704489/529174">following trick</a> mentioned on stackoverflow.</p><p>That covers all I wanted to regarding <i>transclude</i> in AngularJS. Hope this post proves useful to you. Happy ng-ing :).</p><p><b><font color="firebrick">Update (20<sup>th</sup> Feb 2013) - scope and transclude argument to compile function</font></b></p><p>The lack of scope in compile function and the signature of transclude argument to compile function that mentions scope as its first argument leaves a lot of "scope" for confusion :). One thing is certain, there is no scope in compile function. Here it is straight from horse's mouth - <a href="https://groups.google.com/d/msg/angular/QbZt4kw5cTY/h-ZIgPO0wrsJ">https://groups.google.com/d/msg/angular/QbZt4kw5cTY/h-ZIgPO0wrsJ</a>.</p><p>So what's the first argument actually? It turns out it's just the jQuery-wrapped root element of the template for the <b>buttonBar</b> directive. This is how it looks like during debugging - </p><p><a href="http://4.bp.blogspot.com/-qIT5CLnYiSU/USTp2xiGJCI/AAAAAAAAAaA/Sgx35W-8BcE/s1600/elem.jpg" imageanchor="1" ><img border="0" src="http://4.bp.blogspot.com/-qIT5CLnYiSU/USTp2xiGJCI/AAAAAAAAAaA/Sgx35W-8BcE/s320/elem.jpg" /></a>. </p><p>Note the absence of scope related behavior such as <i>$$watchers</i> or <i>$$listeners</i> on it.</p><p><a href="http://jsfiddle.net/ospatil/A969Z/107/">Here</a> is updated version of third fiddle from top with development version of AngularJS instead of minified version. You can put a debug point as shown in the snapshot above and see for yourself. Hope this clarifies it further.</p><p><b><font color="firebrick">Update (16<sup>th</sup> March 2013) - All fiddles updated to latest AngularJS release - 1.1.3</font></b><br /></p><p>In contrast to what I have mentioned in the earlier update and behavior in earlier releases, the transcludeFn passed to compile function now indeed expects scope as first argument in latest AngularJS release (1.0.5/1.1.3). Therefore the call to this function needs to be made from link function that is returned from compile function as it has access to scope. The fiddle for section <i>Transclude argument to compile function in a directive</i> as been modified accordingly.<br /></p></p></div>